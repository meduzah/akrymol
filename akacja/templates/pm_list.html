{% extends "base.html" %}

{% block title %}Lista Project Managerów{% endblock %}

{% block content %}
  <h1>Lista Project Managerów</h1>
  <p>.</p>
{% endblock %}
<form method="POST" action="/delete-pm/{{ pm[0] }}" style="display: inline;">
  <button class="btn btn-danger btn-sm" type="submit">Usuń</button>
</form>
<input type="text" id="filterInput" class="form-control" placeholder="Filtruj po nazwisku...">


<a href="{{ url_for('add_pm') }}" class="btn btn-primary mb-3">Dodaj PM-a</a>

<table class="table" id="pmTable">
  <thead>
    <tr>
      <th>Imię i nazwisko</th>
      <th>Doświadczenie</th>
      <th>Lokalizacja</th>
      <th>Gotowość do podróży</th>
    </tr>
  </thead>
  <tbody>
    {% for pm in pms %}
    <tr>
      <td>{{ pm.name }}</td>
      <td>{{ pm.experience }}</td>
      <td>{{ pm.location }}</td>
      <td>{{ 'Tak' if pm.travel_ready else 'Nie' }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<script>
  const filterInput = document.getElementById('filterInput');
  const table = document.getElementById('pmTable');
  filterInput.addEventListener('keyup', function() {
    const filter = filterInput.value.toLowerCase();
    const rows = table.getElementsByTagName('tr');
    for (let i = 1; i < rows.length; i++) {
      const cells = rows[i].getElementsByTagName('td');
      let match = false;
      for (const cell of cells) {
        if (cell.textContent.toLowerCase().includes(filter)) {
          match = true;
          break;
        }
      }
      rows[i].style.display = match ? '' : 'none';
    }
  });
</script>

